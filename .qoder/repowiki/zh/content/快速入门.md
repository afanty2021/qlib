# 快速入门

<cite>
**本文档中引用的文件**
- [README.md](file://README.md)
- [get_data.py](file://scripts/get_data.py)
- [check_data_health.py](file://scripts/check_data_health.py)
- [workflow_by_code.py](file://examples/workflow_by_code.py)
</cite>

## 目录
1. [简介](#简介)
2. [环境安装](#环境安装)
3. [数据准备](#数据准备)
4. [运行第一个工作流](#运行第一个工作流)
5. [常见问题排查](#常见问题排查)

## 简介
本指南旨在帮助新手用户快速上手 Qlib 平台。通过分步说明，您将学会如何安装环境、获取示例数据集、验证数据健康状态，并成功运行一个完整的工作流。整个过程专注于建立初步体验，避免深入复杂的技术细节。

## 环境安装
Qlib 支持多种 Python 版本（3.8 至 3.12），推荐使用 Conda 来管理 Python 环境以避免依赖冲突。

### 使用 pip 安装
最简单的方式是通过 pip 安装：
```bash
pip install pyqlib
```

### 从源码安装
如果您希望使用最新的开发版本，请按以下步骤操作：
```bash
git clone https://github.com/microsoft/qlib.git && cd qlib
pip install numpy
pip install --upgrade cython
pip install .
```

**注意**：对于 Mac M1 用户，如果遇到 LightGBM 编译问题，请先执行 `brew install libomp` 再进行安装。

**Section sources**
- [README.md](file://README.md#L60-L120)

## 数据准备
在开始建模前，需要先下载并准备金融数据集。

### 获取示例数据
使用 `get_data.py` 脚本可以方便地下载预处理好的数据集。以下是获取中国市场的日频数据的命令：
```bash
python scripts/get_data.py qlib_data --target_dir ~/.qlib/qlib_data/cn_data --region cn
```

该脚本会自动从远程服务器下载数据并解压到指定目录。默认情况下，数据将被存储在用户主目录下的 `.qlib/qlib_data/cn_data` 文件夹中。

**Section sources**
- [get_data.py](file://scripts/get_data.py#L1-L10)
- [README.md](file://README.md#L125-L150)

### 验证数据健康状态
为确保数据完整性，在使用前建议检查数据健康状况。可通过以下命令执行检查：
```bash
python scripts/check_data_health.py check_data --qlib_dir ~/.qlib/qlib_data/cn_data
```

此命令会检测以下问题：
- OHLCV 字段是否存在缺失值
- 是否存在异常大的价格或成交量跳变
- 必需字段是否齐全
- 因子列是否为空

若所有检查均通过，终端将显示“✅”标志，表示数据健康可用。

**Section sources**
- [check_data_health.py](file://scripts/check_data_health.py#L12-L198)

## 运行第一个工作流
完成环境配置和数据准备后，即可启动首个量化研究工作流。

### 使用 qrun 命令
Qlib 提供了 `qrun` 工具来一键运行完整流程。进入 `examples` 目录并执行：
```bash
cd examples
qrun benchmarks/LightGBM/workflow_config_lightgbm_Alpha158.yaml
```

该命令将依次执行以下步骤：
1. 加载 Alpha158 特征数据集
2. 训练 LightGBM 预测模型
3. 执行回测分析
4. 生成绩效报告

最终输出包括年化收益率、信息比率、最大回撤等关键指标。

### 使用 Python 脚本
您也可以通过编写代码方式构建自定义工作流。`workflow_by_code.py` 示例展示了如何用编程方式实现相同功能：
```bash
python examples/workflow_by_code.py
```

这种方式提供了更高的灵活性，便于研究人员根据需求调整模型参数、策略逻辑和评估标准。

**Section sources**
- [README.md](file://README.md#L170-L200)
- [workflow_by_code.py](file://examples/workflow_by_code.py#L1-L85)

## 常见问题排查
### 依赖冲突
当出现包版本不兼容时，建议创建独立的虚拟环境：
```bash
conda create -n qlib python=3.9
conda activate qlib
pip install pyqlib
```

### 数据路径错误
请确保 `--target_dir` 指定的路径具有读写权限，并且磁盘空间充足。若更改了默认路径，请同步更新 `qlib.init()` 中的 `provider_uri` 参数。

### 数据健康检查失败
如果 `check_data_health.py` 报告异常，请尝试重新下载数据：
```bash
python scripts/get_data.py qlib_data --target_dir ~/.qlib/qlib_data/cn_data --region cn --delete_old=True
```

启用 `--delete_old=True` 可强制覆盖旧数据。

**Section sources**
- [README.md](file://README.md#L205-L230)
- [check_data_health.py](file://scripts/check_data_health.py#L12-L198)